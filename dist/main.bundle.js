!function(e){var t={};function n(r){if(t[r])return t[r].exports;var c=t[r]={i:r,l:!1,exports:{}};return e[r].call(c.exports,c,c.exports,n),c.l=!0,c.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var c in e)n.d(r,c,function(t){return e[t]}.bind(null,c));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=3)}([function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},function(e,t,n){"use strict";n.r(t);var r=n(1),c=n.n(r),o=n(0),i=n.n(o),u=function(){function e(){c()(this,e)}return i()(e,null,[{key:"httpGetAllSources",value:function(){return fetch(this.URL_ALL_SOURCES).then(function(e){return 200!==e.status?Promise.reject(e):e.json()}).catch(function(e){var t=e.statusText;return Promise.reject(t)})}},{key:"httpGetArticlesSource",value:function(e,t){var n="".concat(this.URL_SOURCE,"/?sources=").concat(e,"&pageSize=").concat(t);return fetch(n,this.requestOptions).then(function(e){return 200!==e.status?Promise.reject(e):e.json()}).catch(function(e){var t=e.statusText;return Promise.reject(t)})}},{key:"API_KEY",get:function(){return"7e92c05c99e645baacb7560198807645"}},{key:"URL_ALL_SOURCES",get:function(){return"https://newsapi.org/v1/sources"}},{key:"URL_SOURCE",get:function(){return"https://newsapi.org/v2/everything"}},{key:"requestOptions",get:function(){return{method:"GET",mode:"cors",headers:{"X-Api-Key":this.API_KEY}}}}]),e}(),s=n(2),a=n.n(s);function l(e){var t=e.tagName,n=e.innerText,r=e.innerHTML,c=e.className,o=e.attrs,i=document.createElement(t);return c&&i.classList.add(c),n&&(i.innerText=n),r&&(i.innerHTML=r),o&&Object.keys(o).forEach(function(e){i.setAttribute(e,o[e])}),i}var f=function(){function e(t){c()(this,e),this.nodeSourceContent=document.querySelector(t),this.articlesContainer=null}return i()(e,[{key:"createArticles",value:function(){var e=new DocumentFragment,t=l({tagName:"div",className:"source-content__articles"});return this.articlesContainer.forEach(function(e){var n=new Date(e.publishedAt).toLocaleString(),r=e.urlToImage?'<img src="'.concat(e.urlToImage,'" width="180" height="140" alt="Image news" class="source-article__img">'):'<div class="source-article__instead-img"></div>',c=l({tagName:"article",className:"source-article",innerHTML:"\n          ".concat(r,'\n          <h3 class="source-article__title">').concat(e.title,'</h3>\n          <p class="source-article__description">').concat(e.description,'</p>\n          <span class="source-article__date">').concat(n,'</span>\n          <a href="').concat(e.url,'" target="_blank" class="source-article__link">See more</a>')});t.appendChild(c)}),e.appendChild(t),e}},{key:"redirectArticles",value:function(e,t){var n=this,r=this.nodeSourceContent.querySelector(".source-content__articles");r.innerHTML="Please wait...",u.httpGetArticlesSource(e,t).then(function(e){var t=e.articles;n.articles=t,n.viewNameSourceContent(),n.viewArticles()}).catch(function(e){r.innerHTML="",alert("Error. ".concat(e))})}},{key:"viewArticles",value:function(){var e=this.nodeSourceContent.querySelector(".source-content__articles"),t=this.createArticles();e.replaceWith(t)}},{key:"viewNameSourceContent",value:function(){this.nodeSourceContent.querySelector(".source-content__author").innerText=this.articlesContainer[0].source.name}},{key:"articles",set:function(e){this.articlesContainer=e}}]),e}();var d=function(){function e(t){c()(this,e),this.nodeFilterSources=document.querySelector(t),this.countNews=this.countNews,this.nodeFilterSources.querySelector(".filter-sources__range").onchange=function(e){this.countNews=e.target.value;var t=new f(".source-content"),n=new h(".all-sources").idCurrentSource;t.redirectArticles(n,this.countNews)}.bind(this)}return i()(e,[{key:"countNews",set:function(e){this.nodeFilterSources.querySelector(".filter-sources__value").innerText=e},get:function(){var e=this.nodeFilterSources.querySelector(".filter-sources__range").value;return Number(e)}}]),e}();var h=function(){function e(t){c()(this,e),this.nodeSources=document.querySelector(t),this.sourcesContainer=null,this.curentNode=null,document.querySelector(t).onclick=function(e){var t=e.target;if("LI"===t.tagName){var n=t.getAttribute("data-id-source"),r=new d(".filter-sources").countNews,c=new f(".source-content");this.clickCurentNode=t,c.redirectArticles(n,r)}}.bind(this)}return i()(e,null,[{key:"NAME_CLASS_CURENT_NODE",get:function(){return"all-sources__curent-item"}},{key:"DATA_ID_SOURCE",get:function(){return"data-id-source"}}]),i()(e,[{key:"createSources",value:function(){var t=new DocumentFragment;return this.sourcesContainer.forEach(function(n){var r=l({tagName:"li",innerText:n.name,className:"all-sources__item",attrs:a()({},e.DATA_ID_SOURCE,n.id)});t.appendChild(r)}),t}},{key:"viewSources",value:function(){var e=this.createSources();this.nodeSources.appendChild(e)}},{key:"sources",set:function(e){this.sourcesContainer=e}},{key:"clickCurentNode",set:function(t){this.curentNode&&this.curentNode.classList.remove(e.NAME_CLASS_CURENT_NODE),this.curentNode=t,this.curentNode.classList.add(e.NAME_CLASS_CURENT_NODE)}},{key:"idCurrentSource",get:function(){return this.nodeSources.querySelector(".".concat(e.NAME_CLASS_CURENT_NODE)).getAttribute(e.DATA_ID_SOURCE)}}]),e}();u.httpGetAllSources().then(function(e){var t=e.sources;t||Promise.reject(t);var n=new h(".all-sources__list"),r=new f(".source-content"),c=new d(".filter-sources").countNews;n.sources=t,n.viewSources(),n.clickCurentNode=n.nodeSources.firstElementChild,r.redirectArticles(t[0].id,c)}).catch(function(e){alert("Error. ".concat(e))})}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvY3JlYXRlQ2xhc3MuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvY2xhc3NDYWxsQ2hlY2suanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZGVmaW5lUHJvcGVydHkuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2pzL25ld3MtYXBpL25ld3MtYXBpLmpzIiwid2VicGFjazovLy8uL3NyYy9qcy91dGlscy9ub2RlLXV0aWwuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2pzL2NvbXBvbmVudHMvc291cmNlLWNvbnRlbnQvc291cmNlLWNvbnRlbnQuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2pzL2NvbXBvbmVudHMvZmlsdGVyLXNvdXJjZXMvZmlsdGVyLXNvdXJjZXMuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2pzL2NvbXBvbmVudHMvZmlsdGVyLXNvdXJjZXMvZXZlbnRzLWZpbHRlci1zb3VyY2VzLmpzIiwid2VicGFjazovLy8uL3NyYy9qcy9jb21wb25lbnRzL2FsbC1zb3VyY2VzL2FsbC1zb3VyY2VzLmpzIiwid2VicGFjazovLy8uL3NyYy9qcy9jb21wb25lbnRzL2FsbC1zb3VyY2VzL2V2ZW50cy1hbGwtc291cmNlcy5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvanMvYXBwLmpzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiX2RlZmluZVByb3BlcnRpZXMiLCJ0YXJnZXQiLCJwcm9wcyIsImxlbmd0aCIsImRlc2NyaXB0b3IiLCJjb25maWd1cmFibGUiLCJ3cml0YWJsZSIsIkNvbnN0cnVjdG9yIiwicHJvdG9Qcm9wcyIsInN0YXRpY1Byb3BzIiwiaW5zdGFuY2UiLCJUeXBlRXJyb3IiLCJvYmoiLCJOZXdzQXBpIiwiZmV0Y2giLCJ0aGlzIiwiVVJMX0FMTF9TT1VSQ0VTIiwidGhlbiIsInJlc3BvbmNlIiwic3RhdHVzIiwiUHJvbWlzZSIsInJlamVjdCIsImpzb24iLCJjYXRjaCIsIl9yZWYiLCJzdGF0dXNUZXh0IiwiaWRTb3VyY2UiLCJudW1iZXJBcnRpY2xlcyIsInF1ZXJ5VVJMIiwiY29uY2F0IiwiVVJMX1NPVVJDRSIsInJlcXVlc3RPcHRpb25zIiwiX3JlZjIiLCJtZXRob2QiLCJoZWFkZXJzIiwiWC1BcGktS2V5IiwiQVBJX0tFWSIsImNyZWF0ZU5vZGUiLCJ0YWdOYW1lIiwiaW5uZXJUZXh0IiwiaW5uZXJIVE1MIiwiY2xhc3NOYW1lIiwiYXR0cnMiLCJub2RlIiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NMaXN0IiwiYWRkIiwia2V5cyIsImZvckVhY2giLCJhdHRyIiwic2V0QXR0cmlidXRlIiwiU291cmNlQ29udGVudCIsIm5vZGVTZWxlY3RvciIsImNsYXNzQ2FsbENoZWNrX2RlZmF1bHQiLCJub2RlU291cmNlQ29udGVudCIsInF1ZXJ5U2VsZWN0b3IiLCJhcnRpY2xlc0NvbnRhaW5lciIsImZyYWdtZW50Q29udGFpbmVyQXJ0aWNsZXMiLCJEb2N1bWVudEZyYWdtZW50Iiwibm9kZURpdiIsImFydGljbGUiLCJkYXRlIiwiRGF0ZSIsInB1Ymxpc2hlZEF0IiwidG9Mb2NhbGVTdHJpbmciLCJpbm5lcmltZyIsInVybFRvSW1hZ2UiLCJub2RlQXJ0aWNsZSIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJ1cmwiLCJhcHBlbmRDaGlsZCIsImNvdW50TmV3cyIsIl90aGlzIiwibm9kZUFydGljbGVzIiwiaHR0cEdldEFydGljbGVzU291cmNlIiwiYXJ0aWNsZXMiLCJ2aWV3TmFtZVNvdXJjZUNvbnRlbnQiLCJ2aWV3QXJ0aWNsZXMiLCJlcnJvck1lc3NhZ2UiLCJhbGVydCIsImZyYWdtZW50QXJ0aWNsZXMiLCJjcmVhdGVBcnRpY2xlcyIsInJlcGxhY2VXaXRoIiwic291cmNlIiwiRmlsdGVyU291cmNlcyIsIm5vZGVGaWx0ZXJTb3VyY2VzIiwib25jaGFuZ2UiLCJldmVudCIsInNvdXJjZUNvbnRlbnQiLCJpZEN1cnJlbnRTb3VyY2UiLCJBbGxTb3VyY2VzIiwicmVkaXJlY3RBcnRpY2xlcyIsImNvdW50IiwiTnVtYmVyIiwibm9kZVNvdXJjZXMiLCJzb3VyY2VzQ29udGFpbmVyIiwiY3VyZW50Tm9kZSIsIm9uY2xpY2siLCJjbGlja0VsZW0iLCJnZXRBdHRyaWJ1dGUiLCJjbGlja0N1cmVudE5vZGUiLCJmcmFnbWVudENvbnRhaW5lckxpc3QiLCJub2RlTEkiLCJkZWZpbmVQcm9wZXJ0eV9kZWZhdWx0IiwiREFUQV9JRF9TT1VSQ0UiLCJpZCIsImZyYWdtZW50U291cmNlcyIsImNyZWF0ZVNvdXJjZXMiLCJzb3VyY2VzIiwicmVtb3ZlIiwiTkFNRV9DTEFTU19DVVJFTlRfTk9ERSIsImh0dHBHZXRBbGxTb3VyY2VzIiwiYWxsU291cmNlcyIsInZpZXdTb3VyY2VzIiwiZmlyc3RFbGVtZW50Q2hpbGQiXSwibWFwcGluZ3MiOiJhQUNBLElBQUFBLEtBR0EsU0FBQUMsRUFBQUMsR0FHQSxHQUFBRixFQUFBRSxHQUNBLE9BQUFGLEVBQUFFLEdBQUFDLFFBR0EsSUFBQUMsRUFBQUosRUFBQUUsSUFDQUcsRUFBQUgsRUFDQUksR0FBQSxFQUNBSCxZQVVBLE9BTkFJ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bEJuRixLQUFLbUYsV0FBV3BELFVBQVVDLElBQUk2QyxFQUFXb0IsZ0VBT3pDLE9BSG9CakcsS0FBS2lGLFlBQ3RCeEMsY0FEaUIsSUFBQTNCLE9BQ0MrRCxFQUFXb0IseUJBRWJYLGFBQWFULEVBQVdjLHlCRWhDL0M3RixFQUFRb0csb0JBQ0xoRyxLQUFLLFNBQUFPLEdBQWlCLElBQWRzRixFQUFjdEYsRUFBZHNGLFFBQ0ZBLEdBQ0gxRixRQUFRQyxPQUFPeUYsR0FFakIsSUFBTUksRUFBYSxJQUFJdEIsRUFBVyxzQkFDNUJGLEVBQWdCLElBQUl0QyxFQUFjLG1CQUNoQ3FCLEVBQWMsSUFBSWEsRUFBYyxtQkFBaENiLFVBRVJ5QyxFQUFXSixRQUFVQSxFQUNyQkksRUFBV0MsY0FDWEQsRUFBV1osZ0JBQWtCWSxFQUFXbEIsWUFBWW9CLGtCQUNwRDFCLEVBQWNHLGlCQUFpQmlCLEVBQVEsR0FBR0gsR0FBSWxDLEtBRS9DbEQsTUFBTSxTQUFDeUQsR0FDTkMsTUFBSyxVQUFBcEQsT0FBV21EIiwiZmlsZSI6Im1haW4uYnVuZGxlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDMpO1xuIiwiZnVuY3Rpb24gX2RlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykge1xuICBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7XG4gICAgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTtcbiAgICBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7XG4gICAgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlO1xuICAgIGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpO1xuICB9XG59XG5cbmZ1bmN0aW9uIF9jcmVhdGVDbGFzcyhDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHtcbiAgaWYgKHByb3RvUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7XG4gIGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTtcbiAgcmV0dXJuIENvbnN0cnVjdG9yO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IF9jcmVhdGVDbGFzczsiLCJmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7XG4gIGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTtcbiAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IF9jbGFzc0NhbGxDaGVjazsiLCJmdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7XG4gIGlmIChrZXkgaW4gb2JqKSB7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7XG4gICAgICB2YWx1ZTogdmFsdWUsXG4gICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgd3JpdGFibGU6IHRydWVcbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICBvYmpba2V5XSA9IHZhbHVlO1xuICB9XG5cbiAgcmV0dXJuIG9iajtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBfZGVmaW5lUHJvcGVydHk7IiwiXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE5ld3NBcGkge1xyXG4gIHN0YXRpYyBnZXQgQVBJX0tFWSgpIHtcclxuICAgIHJldHVybiAnN2U5MmMwNWM5OWU2NDViYWFjYjc1NjAxOTg4MDc2NDUnO1xyXG4gIH1cclxuXHJcbiAgc3RhdGljIGdldCBVUkxfQUxMX1NPVVJDRVMoKSB7XHJcbiAgICByZXR1cm4gJ2h0dHBzOi8vbmV3c2FwaS5vcmcvdjEvc291cmNlcyc7XHJcbiAgfVxyXG5cclxuICBzdGF0aWMgZ2V0IFVSTF9TT1VSQ0UoKSB7XHJcbiAgICByZXR1cm4gJ2h0dHBzOi8vbmV3c2FwaS5vcmcvdjIvZXZlcnl0aGluZyc7XHJcbiAgfVxyXG5cclxuICBzdGF0aWMgZ2V0IHJlcXVlc3RPcHRpb25zKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgbWV0aG9kOiAnR0VUJyxcclxuICAgICAgbW9kZTogJ2NvcnMnLFxyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgJ1gtQXBpLUtleSc6IHRoaXMuQVBJX0tFWSxcclxuICAgICAgfSxcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBzdGF0aWMgaHR0cEdldEFsbFNvdXJjZXMoKSB7XHJcbiAgICByZXR1cm4gZmV0Y2godGhpcy5VUkxfQUxMX1NPVVJDRVMpXHJcbiAgICAgIC50aGVuKChyZXNwb25jZSkgPT4ge1xyXG4gICAgICAgIGlmIChyZXNwb25jZS5zdGF0dXMgIT09IDIwMCkge1xyXG4gICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KHJlc3BvbmNlKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiByZXNwb25jZS5qc29uKCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaCgoeyBzdGF0dXNUZXh0IH0pID0+IFByb21pc2UucmVqZWN0KHN0YXR1c1RleHQpKTtcclxuICB9XHJcblxyXG4gIHN0YXRpYyBodHRwR2V0QXJ0aWNsZXNTb3VyY2UoaWRTb3VyY2UsIG51bWJlckFydGljbGVzKSB7XHJcbiAgICBjb25zdCBxdWVyeVVSTCA9IGAke3RoaXMuVVJMX1NPVVJDRX0vP3NvdXJjZXM9JHtpZFNvdXJjZX0mcGFnZVNpemU9JHtudW1iZXJBcnRpY2xlc31gO1xyXG5cclxuICAgIHJldHVybiBmZXRjaChxdWVyeVVSTCwgdGhpcy5yZXF1ZXN0T3B0aW9ucylcclxuICAgICAgLnRoZW4oKHJlc3BvbmNlKSA9PiB7XHJcbiAgICAgICAgaWYgKHJlc3BvbmNlLnN0YXR1cyAhPT0gMjAwKSB7XHJcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QocmVzcG9uY2UpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHJlc3BvbmNlLmpzb24oKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKCh7IHN0YXR1c1RleHQgfSkgPT4gUHJvbWlzZS5yZWplY3Qoc3RhdHVzVGV4dCkpO1xyXG4gIH1cclxufVxyXG4iLCJcclxuZnVuY3Rpb24gY3JlYXRlTm9kZSh7XHJcbiAgdGFnTmFtZSwgaW5uZXJUZXh0LCBpbm5lckhUTUwsIGNsYXNzTmFtZSwgYXR0cnMsXHJcbn0pIHtcclxuICBjb25zdCBub2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCh0YWdOYW1lKTtcclxuXHJcbiAgaWYgKGNsYXNzTmFtZSkge1xyXG4gICAgbm9kZS5jbGFzc0xpc3QuYWRkKGNsYXNzTmFtZSk7XHJcbiAgfVxyXG5cclxuICBpZiAoaW5uZXJUZXh0KSB7XHJcbiAgICBub2RlLmlubmVyVGV4dCA9IGlubmVyVGV4dDtcclxuICB9XHJcblxyXG4gIGlmIChpbm5lckhUTUwpIHtcclxuICAgIG5vZGUuaW5uZXJIVE1MID0gaW5uZXJIVE1MO1xyXG4gIH1cclxuXHJcbiAgaWYgKGF0dHJzKSB7XHJcbiAgICBPYmplY3Qua2V5cyhhdHRycykuZm9yRWFjaCgoYXR0cikgPT4ge1xyXG4gICAgICBub2RlLnNldEF0dHJpYnV0ZShhdHRyLCBhdHRyc1thdHRyXSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHJldHVybiBub2RlO1xyXG59XHJcblxyXG5leHBvcnQge1xyXG4gIGNyZWF0ZU5vZGUsXHJcbn07XHJcbiIsImltcG9ydCBOZXdzQXBpIGZyb20gJy4uLy4uL25ld3MtYXBpL25ld3MtYXBpJztcclxuaW1wb3J0IHsgY3JlYXRlTm9kZSB9IGZyb20gJy4uLy4uL3V0aWxzL25vZGUtdXRpbCc7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTb3VyY2VDb250ZW50IHtcclxuICBjb25zdHJ1Y3Rvcihub2RlU2VsZWN0b3IpIHtcclxuICAgIHRoaXMubm9kZVNvdXJjZUNvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5vZGVTZWxlY3Rvcik7XHJcbiAgICB0aGlzLmFydGljbGVzQ29udGFpbmVyID0gbnVsbDtcclxuICB9XHJcblxyXG4gIHNldCBhcnRpY2xlcyhhcnRpY2xlcykge1xyXG4gICAgdGhpcy5hcnRpY2xlc0NvbnRhaW5lciA9IGFydGljbGVzO1xyXG4gIH1cclxuXHJcbiAgY3JlYXRlQXJ0aWNsZXMoKSB7XHJcbiAgICBjb25zdCBmcmFnbWVudENvbnRhaW5lckFydGljbGVzID0gbmV3IERvY3VtZW50RnJhZ21lbnQoKTtcclxuICAgIGNvbnN0IG5vZGVEaXYgPSBjcmVhdGVOb2RlKHtcclxuICAgICAgdGFnTmFtZTogJ2RpdicsXHJcbiAgICAgIGNsYXNzTmFtZTogJ3NvdXJjZS1jb250ZW50X19hcnRpY2xlcycsXHJcbiAgICB9KTtcclxuXHJcbiAgICB0aGlzLmFydGljbGVzQ29udGFpbmVyLmZvckVhY2goKGFydGljbGUpID0+IHtcclxuICAgICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKGFydGljbGUucHVibGlzaGVkQXQpLnRvTG9jYWxlU3RyaW5nKCk7XHJcbiAgICAgIGNvbnN0IGlubmVyaW1nID0gYXJ0aWNsZS51cmxUb0ltYWdlXHJcbiAgICAgICAgPyBgPGltZyBzcmM9XCIke2FydGljbGUudXJsVG9JbWFnZX1cIiB3aWR0aD1cIjE4MFwiIGhlaWdodD1cIjE0MFwiIGFsdD1cIkltYWdlIG5ld3NcIiBjbGFzcz1cInNvdXJjZS1hcnRpY2xlX19pbWdcIj5gXHJcbiAgICAgICAgOiAnPGRpdiBjbGFzcz1cInNvdXJjZS1hcnRpY2xlX19pbnN0ZWFkLWltZ1wiPjwvZGl2Pic7XHJcbiAgICAgIGNvbnN0IG5vZGVBcnRpY2xlID0gY3JlYXRlTm9kZSh7XHJcbiAgICAgICAgdGFnTmFtZTogJ2FydGljbGUnLFxyXG4gICAgICAgIGNsYXNzTmFtZTogJ3NvdXJjZS1hcnRpY2xlJyxcclxuICAgICAgICBpbm5lckhUTUw6IGBcclxuICAgICAgICAgICR7aW5uZXJpbWd9XHJcbiAgICAgICAgICA8aDMgY2xhc3M9XCJzb3VyY2UtYXJ0aWNsZV9fdGl0bGVcIj4ke2FydGljbGUudGl0bGV9PC9oMz5cclxuICAgICAgICAgIDxwIGNsYXNzPVwic291cmNlLWFydGljbGVfX2Rlc2NyaXB0aW9uXCI+JHthcnRpY2xlLmRlc2NyaXB0aW9ufTwvcD5cclxuICAgICAgICAgIDxzcGFuIGNsYXNzPVwic291cmNlLWFydGljbGVfX2RhdGVcIj4ke2RhdGV9PC9zcGFuPlxyXG4gICAgICAgICAgPGEgaHJlZj1cIiR7YXJ0aWNsZS51cmx9XCIgdGFyZ2V0PVwiX2JsYW5rXCIgY2xhc3M9XCJzb3VyY2UtYXJ0aWNsZV9fbGlua1wiPlNlZSBtb3JlPC9hPmAsXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgbm9kZURpdi5hcHBlbmRDaGlsZChub2RlQXJ0aWNsZSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBmcmFnbWVudENvbnRhaW5lckFydGljbGVzLmFwcGVuZENoaWxkKG5vZGVEaXYpO1xyXG5cclxuICAgIHJldHVybiBmcmFnbWVudENvbnRhaW5lckFydGljbGVzO1xyXG4gIH1cclxuXHJcbiAgcmVkaXJlY3RBcnRpY2xlcyhpZFNvdXJjZSwgY291bnROZXdzKSB7XHJcbiAgICBjb25zdCBub2RlQXJ0aWNsZXMgPSB0aGlzLm5vZGVTb3VyY2VDb250ZW50LnF1ZXJ5U2VsZWN0b3IoJy5zb3VyY2UtY29udGVudF9fYXJ0aWNsZXMnKTtcclxuICAgIG5vZGVBcnRpY2xlcy5pbm5lckhUTUwgPSAnUGxlYXNlIHdhaXQuLi4nO1xyXG5cclxuICAgIE5ld3NBcGkuaHR0cEdldEFydGljbGVzU291cmNlKGlkU291cmNlLCBjb3VudE5ld3MpXHJcbiAgICAgIC50aGVuKCh7IGFydGljbGVzIH0pID0+IHtcclxuICAgICAgICB0aGlzLmFydGljbGVzID0gYXJ0aWNsZXM7XHJcbiAgICAgICAgdGhpcy52aWV3TmFtZVNvdXJjZUNvbnRlbnQoKTtcclxuICAgICAgICB0aGlzLnZpZXdBcnRpY2xlcygpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycm9yTWVzc2FnZSkgPT4ge1xyXG4gICAgICAgIG5vZGVBcnRpY2xlcy5pbm5lckhUTUwgPSAnJztcclxuICAgICAgICBhbGVydChgRXJyb3IuICR7ZXJyb3JNZXNzYWdlfWApO1xyXG4gICAgICB9KTtcclxuICB9XHJcblxyXG4gIHZpZXdBcnRpY2xlcygpIHtcclxuICAgIGNvbnN0IG5vZGVBcnRpY2xlcyA9IHRoaXMubm9kZVNvdXJjZUNvbnRlbnQucXVlcnlTZWxlY3RvcignLnNvdXJjZS1jb250ZW50X19hcnRpY2xlcycpO1xyXG4gICAgY29uc3QgZnJhZ21lbnRBcnRpY2xlcyA9IHRoaXMuY3JlYXRlQXJ0aWNsZXMoKTtcclxuXHJcbiAgICBub2RlQXJ0aWNsZXMucmVwbGFjZVdpdGgoZnJhZ21lbnRBcnRpY2xlcyk7XHJcbiAgfVxyXG5cclxuICB2aWV3TmFtZVNvdXJjZUNvbnRlbnQoKSB7XHJcbiAgICBjb25zdCBub2RlTmFtZVNvdXJjZUNvbnRlbnQgPSB0aGlzLm5vZGVTb3VyY2VDb250ZW50LnF1ZXJ5U2VsZWN0b3IoJy5zb3VyY2UtY29udGVudF9fYXV0aG9yJyk7XHJcbiAgICBub2RlTmFtZVNvdXJjZUNvbnRlbnQuaW5uZXJUZXh0ID0gdGhpcy5hcnRpY2xlc0NvbnRhaW5lclswXS5zb3VyY2UubmFtZTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0ICogYXMgRXZlbnRIYW5kbGVycyBmcm9tICcuL2V2ZW50cy1maWx0ZXItc291cmNlcyc7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBGaWx0ZXJTb3VyY2VzIHtcclxuICBjb25zdHJ1Y3Rvcihub2RlU2VsZWN0b3IpIHtcclxuICAgIHRoaXMubm9kZUZpbHRlclNvdXJjZXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5vZGVTZWxlY3Rvcik7XHJcbiAgICB0aGlzLmNvdW50TmV3cyA9IHRoaXMuY291bnROZXdzO1xyXG5cclxuICAgIHRoaXMubm9kZUZpbHRlclNvdXJjZXMucXVlcnlTZWxlY3RvcignLmZpbHRlci1zb3VyY2VzX19yYW5nZScpXHJcbiAgICAgIC5vbmNoYW5nZSA9IEV2ZW50SGFuZGxlcnMuaGFuZGxlckNoYW5nZVJhbmdlLmJpbmQodGhpcyk7XHJcbiAgfVxyXG5cclxuICBzZXQgY291bnROZXdzKGNvdW50TmV3cykge1xyXG4gICAgY29uc3Qgbm9kZUZpbHRlclNvdXJjZXNWYWx1ZSA9IHRoaXMubm9kZUZpbHRlclNvdXJjZXNcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoJy5maWx0ZXItc291cmNlc19fdmFsdWUnKTtcclxuXHJcbiAgICBub2RlRmlsdGVyU291cmNlc1ZhbHVlLmlubmVyVGV4dCA9IGNvdW50TmV3cztcclxuICB9XHJcblxyXG4gIGdldCBjb3VudE5ld3MoKSB7XHJcbiAgICBjb25zdCBjb3VudCA9IHRoaXMubm9kZUZpbHRlclNvdXJjZXNcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoJy5maWx0ZXItc291cmNlc19fcmFuZ2UnKS52YWx1ZTtcclxuICAgIHJldHVybiBOdW1iZXIoY291bnQpO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgU291cmNlQ29udGVudCBmcm9tICcuLi9zb3VyY2UtY29udGVudC9zb3VyY2UtY29udGVudCc7XHJcbmltcG9ydCBBbGxTb3VyY2VzIGZyb20gJy4uL2FsbC1zb3VyY2VzL2FsbC1zb3VyY2VzJztcclxuXHJcbmZ1bmN0aW9uIGhhbmRsZXJDaGFuZ2VSYW5nZShldmVudCkge1xyXG4gIHRoaXMuY291bnROZXdzID0gZXZlbnQudGFyZ2V0LnZhbHVlO1xyXG5cclxuICBjb25zdCBzb3VyY2VDb250ZW50ID0gbmV3IFNvdXJjZUNvbnRlbnQoJy5zb3VyY2UtY29udGVudCcpO1xyXG4gIGNvbnN0IHsgaWRDdXJyZW50U291cmNlIH0gPSBuZXcgQWxsU291cmNlcygnLmFsbC1zb3VyY2VzJyk7XHJcblxyXG4gIHNvdXJjZUNvbnRlbnQucmVkaXJlY3RBcnRpY2xlcyhpZEN1cnJlbnRTb3VyY2UsIHRoaXMuY291bnROZXdzKTtcclxufVxyXG5cclxuZXhwb3J0IHtcclxuICBoYW5kbGVyQ2hhbmdlUmFuZ2UsXHJcbn07XHJcbiIsImltcG9ydCB7IGNyZWF0ZU5vZGUgfSBmcm9tICcuLi8uLi91dGlscy9ub2RlLXV0aWwnO1xyXG5pbXBvcnQgKiBhcyBFdmVudEhhbmRsZXJzIGZyb20gJy4vZXZlbnRzLWFsbC1zb3VyY2VzJztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEFsbFNvdXJjZXMge1xyXG4gIHN0YXRpYyBnZXQgTkFNRV9DTEFTU19DVVJFTlRfTk9ERSgpIHtcclxuICAgIHJldHVybiAnYWxsLXNvdXJjZXNfX2N1cmVudC1pdGVtJztcclxuICB9XHJcblxyXG4gIHN0YXRpYyBnZXQgREFUQV9JRF9TT1VSQ0UoKSB7XHJcbiAgICByZXR1cm4gJ2RhdGEtaWQtc291cmNlJztcclxuICB9XHJcblxyXG4gIGNvbnN0cnVjdG9yKG5vZGVTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5ub2RlU291cmNlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Iobm9kZVNlbGVjdG9yKTtcclxuICAgIHRoaXMuc291cmNlc0NvbnRhaW5lciA9IG51bGw7XHJcbiAgICB0aGlzLmN1cmVudE5vZGUgPSBudWxsO1xyXG5cclxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Iobm9kZVNlbGVjdG9yKVxyXG4gICAgICAub25jbGljayA9IEV2ZW50SGFuZGxlcnMuaGFuZGxlckNsaWNrLmJpbmQodGhpcyk7XHJcbiAgfVxyXG5cclxuICBzZXQgc291cmNlcyhzb3VyY2VzKSB7XHJcbiAgICB0aGlzLnNvdXJjZXNDb250YWluZXIgPSBzb3VyY2VzO1xyXG4gIH1cclxuXHJcbiAgc2V0IGNsaWNrQ3VyZW50Tm9kZShjdXJlbnROb2RlKSB7XHJcbiAgICBpZiAodGhpcy5jdXJlbnROb2RlKSB7XHJcbiAgICAgIHRoaXMuY3VyZW50Tm9kZS5jbGFzc0xpc3QucmVtb3ZlKEFsbFNvdXJjZXMuTkFNRV9DTEFTU19DVVJFTlRfTk9ERSk7XHJcbiAgICB9XHJcbiAgICB0aGlzLmN1cmVudE5vZGUgPSBjdXJlbnROb2RlO1xyXG4gICAgdGhpcy5jdXJlbnROb2RlLmNsYXNzTGlzdC5hZGQoQWxsU291cmNlcy5OQU1FX0NMQVNTX0NVUkVOVF9OT0RFKTtcclxuICB9XHJcblxyXG4gIGdldCBpZEN1cnJlbnRTb3VyY2UoKSB7XHJcbiAgICBjb25zdCBjdXJyZW50Tm9kZSA9IHRoaXMubm9kZVNvdXJjZXNcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoYC4ke0FsbFNvdXJjZXMuTkFNRV9DTEFTU19DVVJFTlRfTk9ERX1gKTtcclxuXHJcbiAgICByZXR1cm4gY3VycmVudE5vZGUuZ2V0QXR0cmlidXRlKEFsbFNvdXJjZXMuREFUQV9JRF9TT1VSQ0UpO1xyXG4gIH1cclxuXHJcbiAgY3JlYXRlU291cmNlcygpIHtcclxuICAgIGNvbnN0IGZyYWdtZW50Q29udGFpbmVyTGlzdCA9IG5ldyBEb2N1bWVudEZyYWdtZW50KCk7XHJcblxyXG4gICAgdGhpcy5zb3VyY2VzQ29udGFpbmVyLmZvckVhY2goKHNvdXJjZSkgPT4ge1xyXG4gICAgICBjb25zdCBub2RlTEkgPSBjcmVhdGVOb2RlKHtcclxuICAgICAgICB0YWdOYW1lOiAnbGknLFxyXG4gICAgICAgIGlubmVyVGV4dDogc291cmNlLm5hbWUsXHJcbiAgICAgICAgY2xhc3NOYW1lOiAnYWxsLXNvdXJjZXNfX2l0ZW0nLFxyXG4gICAgICAgIGF0dHJzOiB7IFtBbGxTb3VyY2VzLkRBVEFfSURfU09VUkNFXTogc291cmNlLmlkIH0sXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgZnJhZ21lbnRDb250YWluZXJMaXN0LmFwcGVuZENoaWxkKG5vZGVMSSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gZnJhZ21lbnRDb250YWluZXJMaXN0O1xyXG4gIH1cclxuXHJcbiAgdmlld1NvdXJjZXMoKSB7XHJcbiAgICBjb25zdCBmcmFnbWVudFNvdXJjZXMgPSB0aGlzLmNyZWF0ZVNvdXJjZXMoKTtcclxuICAgIHRoaXMubm9kZVNvdXJjZXMuYXBwZW5kQ2hpbGQoZnJhZ21lbnRTb3VyY2VzKTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFNvdXJjZUNvbnRlbnQgZnJvbSAnLi4vc291cmNlLWNvbnRlbnQvc291cmNlLWNvbnRlbnQnO1xyXG5pbXBvcnQgRmlsdGVyU291cmNlcyBmcm9tICcuLi9maWx0ZXItc291cmNlcy9maWx0ZXItc291cmNlcyc7XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVyQ2xpY2soZXZlbnQpIHtcclxuICBjb25zdCBjbGlja0VsZW0gPSBldmVudC50YXJnZXQ7XHJcblxyXG4gIGlmIChjbGlja0VsZW0udGFnTmFtZSA9PT0gJ0xJJykge1xyXG4gICAgY29uc3QgaWRTb3VyY2UgPSBjbGlja0VsZW0uZ2V0QXR0cmlidXRlKCdkYXRhLWlkLXNvdXJjZScpO1xyXG4gICAgY29uc3QgeyBjb3VudE5ld3MgfSA9IG5ldyBGaWx0ZXJTb3VyY2VzKCcuZmlsdGVyLXNvdXJjZXMnKTtcclxuICAgIGNvbnN0IHNvdXJjZUNvbnRlbnQgPSBuZXcgU291cmNlQ29udGVudCgnLnNvdXJjZS1jb250ZW50Jyk7XHJcblxyXG4gICAgdGhpcy5jbGlja0N1cmVudE5vZGUgPSBjbGlja0VsZW07XHJcbiAgICBzb3VyY2VDb250ZW50LnJlZGlyZWN0QXJ0aWNsZXMoaWRTb3VyY2UsIGNvdW50TmV3cyk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQge1xyXG4gIGhhbmRsZXJDbGljayxcclxufTtcclxuIiwiaW1wb3J0IE5ld3NBcGkgZnJvbSAnLi9uZXdzLWFwaS9uZXdzLWFwaSc7XHJcbmltcG9ydCBBbGxTb3VyY2VzIGZyb20gJy4vY29tcG9uZW50cy9hbGwtc291cmNlcy9hbGwtc291cmNlcyc7XHJcbmltcG9ydCBTb3VyY2VDb250ZW50IGZyb20gJy4vY29tcG9uZW50cy9zb3VyY2UtY29udGVudC9zb3VyY2UtY29udGVudCc7XHJcbmltcG9ydCBGaWx0ZXJTb3VyY2VzIGZyb20gJy4vY29tcG9uZW50cy9maWx0ZXItc291cmNlcy9maWx0ZXItc291cmNlcyc7XHJcblxyXG5OZXdzQXBpLmh0dHBHZXRBbGxTb3VyY2VzKClcclxuICAudGhlbigoeyBzb3VyY2VzIH0pID0+IHtcclxuICAgIGlmICghc291cmNlcykge1xyXG4gICAgICBQcm9taXNlLnJlamVjdChzb3VyY2VzKTtcclxuICAgIH1cclxuICAgIGNvbnN0IGFsbFNvdXJjZXMgPSBuZXcgQWxsU291cmNlcygnLmFsbC1zb3VyY2VzX19saXN0Jyk7XHJcbiAgICBjb25zdCBzb3VyY2VDb250ZW50ID0gbmV3IFNvdXJjZUNvbnRlbnQoJy5zb3VyY2UtY29udGVudCcpO1xyXG4gICAgY29uc3QgeyBjb3VudE5ld3MgfSA9IG5ldyBGaWx0ZXJTb3VyY2VzKCcuZmlsdGVyLXNvdXJjZXMnKTtcclxuXHJcbiAgICBhbGxTb3VyY2VzLnNvdXJjZXMgPSBzb3VyY2VzO1xyXG4gICAgYWxsU291cmNlcy52aWV3U291cmNlcygpO1xyXG4gICAgYWxsU291cmNlcy5jbGlja0N1cmVudE5vZGUgPSBhbGxTb3VyY2VzLm5vZGVTb3VyY2VzLmZpcnN0RWxlbWVudENoaWxkO1xyXG4gICAgc291cmNlQ29udGVudC5yZWRpcmVjdEFydGljbGVzKHNvdXJjZXNbMF0uaWQsIGNvdW50TmV3cyk7XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycm9yTWVzc2FnZSkgPT4ge1xyXG4gICAgYWxlcnQoYEVycm9yLiAke2Vycm9yTWVzc2FnZX1gKTtcclxuICB9KTtcclxuIl0sInNvdXJjZVJvb3QiOiIifQ==